<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/>
    <link rel="stylesheet" type="text/css" href="css/styles.css"/>
</head>
<body class="theme_green">

<div class="block">
    <p>This is the AssetCache plugin, enter an URL or Path, and click on the "Download" or "Delete" button.</p>
</div>

<div class="block">
    <input id="url" type="url" placeholder="URL">
    <input id="path" type="text" placeholder="Path">
    <a href="javascript:;" id="download">Download</a>
    <a href="javascript:;" id="delete">Delete</a>
</div>

<div class="block">
    <p>Result of action :<b id="resultField" style="border:1px solid #ccc; padding:5px;"></b></p>
    <p>List of local files :<b id="listField" style="border:1px solid #ccc; padding:5px;"></b></p>

</div>
<script type="text/javascript" src="js/zepto.min.js"></script>
<script type="text/javascript" src="js/Cobalt-Web/cobalt.js"></script>


<script type="text/javascript" src="js/Plugins-AssetCache-Web/cobalt.assetcache.js"></script>
<script type="text/javascript" src="js/app.js"></script>

<script>
  Zepto(function($) {
    cobalt.init();

    app.touch('#download', function() {
      cobalt.assetCache.download({
        'url' : url
      }, function(index) {
        cobalt.log('download callback', data)
        document.getElementById('resultField').innerHTML = data.status;
        if (data.status = 'error')
            document.getElementById('resultField').innerHTML = ' : ' + data.cause;
        //TODO Fill listField
      });

      app.touch('#delete', function() {

      var options;
      if (isNan(url))
        options = {'path'= path};
      else
        options = {'url' = url};

      cobalt.assetCache.delete(options, function(index) {
        cobalt.log('delete callback', data)
        document.getElementById('resultField').innerHTML = data.status;
        if (data.status = 'error')
            document.getElementById('resultField').innerHTML = ' : ' + data.cause;
        //TODO Fill listField
      });
    });
    });
    app.initPage('AssetCache Plugin')
  })
</script>

</body>
</html>

